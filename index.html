<script src="/socket.io/socket.io.js"></script>
<script src="/lib/user.js"></script>
<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
<link rel="stylesheet" type="text/css" href="home.css">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.6" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />
</head>
<script>
	var socket = io.connect("http://" + window.location.host + "/");
	var games_array = new Array();

	function Game() {

		var game = $("#gamename").val();
		var name_exists = false;

		for ( var i in games_array) {
			if (games_array[i] == game) {
				name_exists = true;
			}
		}

		if (game && !name_exists) {
			socket.emit('game', game);
			window.location.href = "http://" + window.location.host
					+ "/editor.html" + "?gameid=" + game;
		} else if (name_exists) {
			alert('Game already exists!');
		}

		else {
			alert('Provide a valid name!');
		}
	}

	function verwijder(id) {
		var dir = './Games/' + id;
		socket.emit('delete game', dir);
		$("#" + id).remove();
		console.log(id);
	}

	function verwijderbutton(id) {
		$("#" + id).parent().remove();
	}

	function searchGames() {
		socket.emit('search', function(games) {
			games_array = games;
			$("#loading").hide();
			for ( var i in games) {
				var html = '<a href="/editor.html?gameid=' + games[i] + '">'
						+ games[i] + '</a>';
				var deletebutton = '<button id="' + games[i] + "del"
						+ '" class="button_delete" onclick="verwijder(\''
						+ games[i]
						+ '\');verwijderbutton(this.id);">Delete</button>';
				$("ul").append('<li>' + deletebutton + html + '</li>');
			}
		});
	}
</script>
</head>
<body onload="searchGames()">


	<h2>Existing games</h2>
	<button class="button_new" onclick='$("#new_game").show();'>Make
		a new Game</button>
	<br>
	<div id="new_game">
		Game name (must be unique):<br> <input type="text"
			class="nice-input" name="gamename" id="gamename">
		<button class="button_create" onclick="Game()">Create</button>
	</div>
	<div id ="loading">
	<img src="/img/loading.gif"/>
	</div>
	<ul>
	</ul>


</body>
</html>